<div class="card card-style loader-container">
  <app-progress-spinner [optionsInfoAreaId]="constructorInfoAreaId">
  </app-progress-spinner>
  <div class="menu-title">
    <p class="color-highlight">{{ formInfo.formTitle }}</p>
    <a class="close-menu" (click)="onFormCancel()"
      ><i class="fa fa-times-circle"></i
    ></a>
    <hr />
  </div>
  <div class="content mb-0">
    <p class="mb-0 color-highlight font-600 font-12">
      {{ formInfo.formDescription }}
    </p>

    <p>
      {{ "TITLE.Be_Careful_When_Entering_Information" | translate }}
    </p>
    <!--Content-->
    <app-cms-form-result-message
      [formInfo]="formInfo"
    ></app-cms-form-result-message>
    <form
      (ngSubmit)="onFormSubmit()"
      #vform="ngForm"
      [ngStyle]="{ direction: tokenInfo?.access?.direction }"
      >
      {{ formInfo.formTitle }}
      <!-- RecieveMethod Field -->
      <div
        class="input-style has-borders input-style-always-active validate-field no-icon mb-4"
        >
        <select
          id="dataModel.recieveMethod"
          [(ngModel)]="dataModel.recieveMethod"
          name="dataModel.recieveMethod"
          #RecordStatus="ngModel"
          class="form-control validate-name"
          >
          @for (item of recieveMethodListItems; track item; let i = $index) {
            <option
              [value]="item.value"
              >
              {{ item.description }}
            </option>
          }
        </select>
        <em>{{
          "TITLE.Select_the_method_of_receiving_the_file" | translate
        }}</em>
        @if (RecordStatus.errors?.required) {
          <mat-error>
            RecordStatus is <strong>{{ "MESSAGE.required" | translate }}</strong>
          </mat-error>
        }
      </div>
      <!-- FileType Field -->
      <div
        class="input-style has-borders input-style-always-active validate-field no-icon mb-4"
        >
        <div class="d-flex align-items-center justify-content-between">
          <div class="flex-grow-1" style="margin-left: 10px">
            <select
              id="dataModel.fileType"
              [(ngModel)]="dataModel.fileType"
              name="dataModel.fileType"
              #RecordStatus="ngModel"
              class="form-control validate-name"
              (change)="this.formInfo.clearSubmitResult()"
              >
              @for (item of fileTypeListItems; track item; let i = $index) {
                <option
                  [value]="item.value"
                  >
                  {{ item.description }}
                </option>
              }
            </select>
            <em>{{ "TITLE.Select_the_file_format" | translate }}</em>
            @if (RecordStatus.errors?.required) {
              <mat-error>
                RecordStatus is
                <strong>{{ "MESSAGE.required" | translate }}</strong>
              </mat-error>
            }
          </div>
          @if (
            dataModel.fileType == EnumExportFileTypeExcel ||
            dataModel.fileType == EnumExportFileTypePDF
            ) {
            <!-- Data Row Orientation Icons -->
            <div
              class="d-flex gap-2 align-items-center"
              style="margin-right: 10px"
              >
              <button
                type="button"
                class="btn btn-sm p-2"
                [ngStyle]="{
                  background:
                    dataModel.dataRowOrientation ===
                    EnumExportFileDataRowOrientationVertical
                      ? '#4CAF50'
                      : '#e0e0e0',
                  border: 'none',
                  'border-radius': '8px',
                  transition: 'all 0.3s ease',
                  cursor: 'pointer',
                }"
                (click)="
                  dataModel.dataRowOrientation =
                    EnumExportFileDataRowOrientationVertical
                "
                [title]="'TITLE.Vertical' | translate"
                >
                <i
                  class="fa-solid fa-arrows-up-down"
                  [ngStyle]="{
                    color:
                      dataModel.dataRowOrientation ===
                      EnumExportFileDataRowOrientationVertical
                        ? 'white'
                        : '#757575',
                    'font-size': '18px',
                  }"
                ></i>
              </button>
              <button
                type="button"
                class="btn btn-sm p-2"
                [ngStyle]="{
                  background:
                    dataModel.dataRowOrientation ===
                    EnumExportFileDataRowOrientationHorizontal
                      ? '#2196F3'
                      : '#e0e0e0',
                  border: 'none',
                  'border-radius': '8px',
                  transition: 'all 0.3s ease',
                  cursor: 'pointer',
                }"
                (click)="
                  dataModel.dataRowOrientation =
                    EnumExportFileDataRowOrientationHorizontal
                "
                [title]="'TITLE.Horizontal' | translate"
                >
                <i
                  class="fa-solid fa-arrows-left-right"
                  [ngStyle]="{
                    color:
                      dataModel.dataRowOrientation ===
                      EnumExportFileDataRowOrientationHorizontal
                        ? 'white'
                        : '#757575',
                    'font-size': '18px',
                  }"
                ></i>
              </button>
            </div>
          }
        </div>
      </div>

      @if (dataModel.fileType == EnumExportFileTypeReport) {
        <!-- ReportFormatFileId Field -->
        <div
          class="input-style has-borders input-style-always-active validate-field no-icon mb-4"
          >
          <label for="dataModel.reportFormatFileId" class="color-highlight">{{
            "TITLE.Report_Format" | translate
          }}</label>
          <select
            id="dataModel.reportFormatFileId"
            [(ngModel)]="dataModel.reportFormatFileId"
            name="dataModel.reportFormatFileId"
            #RecordStatus="ngModel"
            class="form-control validate-name"
            >
            @for (
              item of dataModelReportFileResult.listItems; track
              item; let i = $index) {
              <option
                [value]="item.id"
                (onSelectionChange)="onActionFileSelect(item)"
                >
                {{ item.title }}
              </option>
            }
          </select>
          <em>{{ "TITLE.Report_Format_Select" | translate }}</em>
          @if (RecordStatus.errors?.required) {
            <mat-error>
              RecordStatus is
              <strong>{{ "MESSAGE.required" | translate }}</strong>
            </mat-error>
          }
        </div>
      }
      <div class="form-actions">
        <button
          type="button"
          (click)="onFormCancel()"
          class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-gray"
          >
          <i class="ft-x"></i> {{ "ACTION.CANCEL" | translate }}
        </button>
        <button
          type="submit"
          class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-green"
          style="margin: 1px"
          [disabled]="!vform.form.valid || !formInfo.submitButtonEnabled"
          >
          <i class="fa-solid fa-print"></i>
          {{ "ACTION.FILE_CREATION" | translate }}
        </button>
        @if (
          dataModelSubmitResult &&
          dataModelSubmitResult.isSuccess &&
          dataModelSubmitResult.linkFile?.length > 0
          ) {
          <button
            type="button"
            (click)="onOpenPage()"
            class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-highlight"
            style="margin: 1px"
            >
            <i class="fa-solid fa-download"></i>
            {{ "TITLE.download_link" | translate }}
          </button>
        }
      </div>
    </form>
    <!--Content-->
  </div>
</div>
