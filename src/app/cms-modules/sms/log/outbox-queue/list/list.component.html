<app-cms-html-list
  [optionsListInfoAreaId]="constructorInfoAreaId"
  [optionGuideNoticeKey]="''"
  [(optionActionGuideNoticeDisplay)]="viewGuideNotice"
  (optionOnActionButtonMemoRow)="onActionButtonMemoRow()"
  (optionOnActionButtonMemo)="onActionButtonMemo()"
  (optionOnActionButtonExport)="onActionButtonExport()"
  (optionOnActionButtonPrintRow)="onActionButtonPrintRow()"
  [optionTreeDisplay]="false"
  [optionActionRowId]="tableRowSelected?.id"
  [optionActionRowDisplayMenu]="tableRowSelect2Click"
  [optionSelectRowItemTitle]="tableRowSelected?.id"
  >
  <ng-container cms-tree>
    <!--begin:::::::::::::::::::::::::::::::::::::::::cms-tree-->
    <app-sms-apipath-tree
      (optionChange)="onActionSelectorSelect($event)"
    ></app-sms-apipath-tree>

    <!--end:::::::::::::::::::::::::::::::::::::::::cms-tree-->
  </ng-container>
  <ng-container cms-header>
    <!--begin:::::::::::::::::::::::::::::::::::::::::cms-header-->

    <!--end:::::::::::::::::::::::::::::::::::::::::cms-header-->
  </ng-container>
  <ng-container cms-action-header>
    <!--begin:::::::::::::::::::::::::::::::::::::::::cms-action-header-->
    <!--end:::::::::::::::::::::::::::::::::::::::::cms-action-header-->
  </ng-container>
  <ng-container cms-action-header-start>
    <!--begin:::::::::::::::::::::::::::::::::::::::::cms-action-header-start-->
    @if (
      dataModelResult?.access?.accessDeleteRow &&
      selectedRowsForBulkDelete.size > 0
    ) {
      <a
        type="button"
        class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-highlight"
        (click)="onActionButtonBulkDelete()"
        target="_blank"
      >
        <i class="fa-solid fa-trash-can font-18" style="color: #ff0000"></i>
        {{ "ACTION.DELETE_SELECTED" | translate }} ({{ getSelectedCount() }})
      </a>
    }
    <a
      type="button"
      class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-highlight"
      (click)="viewGuideNotice = !viewGuideNotice"
      target="_blank"
      >
      <i class="fa-solid fa-info font-18" style="color: #ffffff"></i>
    </a>
    <a
      type="button"
      class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-highlight"
      (click)="onActionButtonReload()"
      target="_blank"
      >
      <i
        class="fa-solid fa-rotate-right font-18"
        style="color: #ffffff"
        [class.rotation360]="
          publicHelper.processService.process.inRunArea[constructorInfoAreaId]
        "
      ></i>
    </a>
    <!--end:::::::::::::::::::::::::::::::::::::::::cms-action-header-start-->
  </ng-container>
  <ng-container cms-action-header-end>
    <!--begin:::::::::::::::::::::::::::::::::::::::::cms-action-header-end-->
    <a
      (click)="optionsSearch.data.show = !optionsSearch.data.show"
      class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-highlight"
      >
      <mat-slide-toggle [checked]="optionsSearch.data.show"></mat-slide-toggle
        >{{ "ACTION.SEARCH" | translate }}
      </a>
      <a
        (click)="onActionButtonStatist()"
        class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-highlight"
        >
        <mat-slide-toggle [checked]="optionsStatist.data.show"> </mat-slide-toggle
          >{{ "ACTION.STATIST" | translate }}
        </a>
        <!--end:::::::::::::::::::::::::::::::::::::::::cms-action-header-end-->
      </ng-container>
      <ng-container cms-action-main>
        <!--begin:::::::::::::::::::::::::::::::::::::::::cms-action-->
        @if (
          dataModelResult?.access?.accessDeleteRow &&
          selectedRowsForBulkDelete.size > 0
        ) {
          <div class="col-4">
            <a
              (click)="onActionButtonBulkDelete()"
              class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-red"
              target="_blank"
              ><i class="fa-solid fa-trash-can font-18" style="color: #ffffff"></i
              ><br />
            </a>
            <p class="font-11 text-center opacity-70">
              {{ "ACTION.DELETE_SELECTED" | translate }} ({{ getSelectedCount() }})
            </p>
          </div>
        }
        <!--end:::::::::::::::::::::::::::::::::::::::::cms-action-->
      </ng-container>
      <ng-container cms-action-row>
        <!--begin:::::::::::::::::::::::::::::::::::::::::cms-action-row-->
        @if (dataModelResult?.access?.accessEditRow) {
          <div class="col-4">
            <a
              (click)="onActionButtonEditRow(tableRowSelected)"
              class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-magenta"
              target="_blank"
              ><i class="fa-solid fa-pen font-18" style="color: #ffffff"></i><br />
            </a>
            <p class="font-11 text-center opacity-70">
              {{ "ACTION.EDIT" | translate }}
            </p>
          </div>
        }
        @if (dataModelResult?.access?.accessDeleteRow) {
          <div class="col-4">
            <a
              (click)="onActionButtonDeleteRow(tableRowSelected)"
              class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-red"
              target="_blank"
              ><i class="fa-solid fa-trash font-18" style="color: #ffffff"></i><br />
            </a>
            <p class="font-11 text-center opacity-70">
              {{ "ACTION.DELETE" | translate }}
            </p>
          </div>
        }

        @if (
          dataModelResult?.access?.accessWatchRow &&
          tableRowSelected?.id?.length > 0
          ) {
          <div
            class="col-4"
            >
            <a
              (click)="onActionButtonViewRow(tableRowSelected)"
              type="button"
              class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-highlight"
              target="_blank"
              data-toggle="modal"
              data-target="#categoryModal"
              ><i class="fa-solid fa-eye font-18" style="color: #ffffff"></i><br
            /></a>
            <p class="font-11 text-center opacity-70">
              {{ "ACTION.VIEW" | translate }}
            </p>
          </div>
        }

        <!--end:::::::::::::::::::::::::::::::::::::::::cms-action-row-->
      </ng-container>
      <ng-container cms-action-area>
        <!--begin:::::::::::::::::::::::::::::::::::::::::cms-action-area-->
        <app-cms-search-list [(options)]="optionsSearch"></app-cms-search-list>

        <app-cms-statist-list [(options)]="optionsStatist"></app-cms-statist-list>
        <!--end:::::::::::::::::::::::::::::::::::::::::cms-action-area-->
      </ng-container>
      <ng-container cms-body>
        <!--begin:::::::::::::::::::::::::::::::::::::::::cms-body-->
        <mat-table
          [dataSource]="tableSource"
          matSort
          #tableSort="matSort"
          (matSortChange)="onTableSortData(tableSort)"
          multiTemplateDataRows
          >
          <!-- ID Column -->
          <ng-container matColumnDef="id">
            <mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ fieldsInfo["id"]?.fieldTitle }}
            </mat-header-cell>
            <mat-cell *matCellDef="let row"> {{ row.id }} </mat-cell>
          </ng-container>

          <!-- RecordStatus Column -->
          <ng-container matColumnDef="recordStatus">
            <mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ fieldsInfo["recordStatus"]?.fieldTitle }}
            </mat-header-cell>
            <mat-cell
              *matCellDef="let row"
              [ngClass]="row.recordStatus | statusCellClass"
              >
              <i [ngClass]="row.recordStatus | statusIconClass"></i>
              @if (
                fieldsInfo["recordStatus"]?.accessEditField &&
                !row.queueCompleted &&
                !row.queueLockedRun
                ) {
                @if (dataModelResult?.access?.accessEditRow) {
                  <select
                    matNativeControl
                    cmsRecordStatusSelfSave
                    [contentService]="contentService"
                    [row]="row"
                    style="background: none; border: none"
              [ngStyle]="{
                display: row.id === tableRowSelected?.id ? '' : 'none',
              }"
                  ></select>
                }
              }
            </mat-cell>
          </ng-container>

          <!-- adminRecordStatus Column -->
          <ng-container matColumnDef="adminRecordStatus">
            <mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ fieldsInfo["adminRecordStatus"]?.fieldTitle }}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
              <i [ngClass]="row.adminRecordStatus | adminStatusIconClass"></i>
              @if (
                fieldsInfo["adminRecordStatus"]?.accessEditField &&
                !row.queueCompleted &&
                !row.queueLockedRun
                ) {
                <select
                  matNativeControl
                  cmsRecordAdminStatusSelfSave
                  [contentService]="contentService"
                  [row]="row"
                  style="background: none; border: none"
              [ngStyle]="{
                display: row.id === tableRowSelected?.id ? '' : 'none',
              }"
                ></select>
              }
            </mat-cell>
          </ng-container>
          <!-- createdBy Column -->
          <ng-container matColumnDef="createdBy">
            <mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ fieldsInfo["createdBy"]?.fieldTitle }}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
              {{ row.createdBy | cmsuserinfo | async }}
            </mat-cell>
          </ng-container>
          <!-- scheduleSendStart Column -->
          <ng-container matColumnDef="scheduleSendStart">
            <mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ fieldsInfo["scheduleSendStart"]?.fieldTitle }}
            </mat-header-cell>
            <mat-cell *matCellDef="let row" style="direction: ltr">
              {{ row.scheduleSendStart | localeDateTime }}</mat-cell
              >
            </ng-container>
            <!-- scheduleSendExpire Column -->
            <ng-container matColumnDef="scheduleSendExpire">
              <mat-header-cell *matHeaderCellDef mat-sort-header>
                {{ fieldsInfo["scheduleSendExpire"]?.fieldTitle }}
              </mat-header-cell>
              <mat-cell *matCellDef="let row" style="direction: ltr">
                {{ row.scheduleSendExpire | localeDateTime }}</mat-cell
                >
              </ng-container>
              <!-- queueAllowNextRun Column -->
              <ng-container matColumnDef="queueAllowNextRun">
                <mat-header-cell *matHeaderCellDef mat-sort-header>
                  {{ fieldsInfo["queueAllowNextRun"]?.fieldTitle }}
                </mat-header-cell>
                <mat-cell *matCellDef="let row" style="direction: ltr">
                  {{ row.queueAllowNextRun | localeDateTime }}</mat-cell
                  >
                </ng-container>

                <!-- QueueCompleted Column -->
                <ng-container matColumnDef="queueCompleted">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>
                    {{ fieldsInfo["queueCompleted"]?.fieldTitle }}
                  </mat-header-cell>
                  <mat-cell *matCellDef="let row">
                    <i [ngClass]="row.queueCompleted | boolclass"></i>
                  </mat-cell>
                </ng-container>
                <!-- QueueCompleteDate Column -->
                <ng-container matColumnDef="queueCompleteDate">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>
                    {{ fieldsInfo["queueCompleteDate"]?.fieldTitle }}
                  </mat-header-cell>
                  <mat-cell *matCellDef="let row" style="direction: ltr">
                    {{ row.queueCompleteDate | localeDateTime }}</mat-cell
                    >
                  </ng-container>

                  <!-- CreatedDate Column -->
                  <ng-container matColumnDef="createdDate">
                    <mat-header-cell *matHeaderCellDef mat-sort-header>
                      {{ fieldsInfo["createdDate"]?.fieldTitle }}
                    </mat-header-cell>
                    <mat-cell *matCellDef="let row" style="direction: ltr">
                      {{ row.createdDate | localeDateTime }}</mat-cell
                      >
                    </ng-container>
                    <!-- UpdatedDate Column -->
                    <ng-container matColumnDef="updatedDate">
                      <mat-header-cell *matHeaderCellDef mat-sort-header>
                        {{ fieldsInfo["updatedDate"]?.fieldTitle }}
                      </mat-header-cell>
                      <mat-cell *matCellDef="let row" style="direction: ltr">
                        {{ row.updatedDate | localeDateTime }}
                        {{ publicHelper.getTime(row.updatedDate) }}
                      </mat-cell>
                    </ng-container>

                    <!-- Action Column -->
                    <ng-container matColumnDef="Action">
                      <mat-header-cell *matHeaderCellDef>
                        {{ "TITLE.OPTION" | translate }}
                      </mat-header-cell>
                      <mat-cell *matCellDef="let row" class="Action">
                        <!-- Action Menu -->
                        <button
                          type="button"
                          mat-icon-button
                          [matMenuTriggerFor]="actionMenu"
                          aria-label="Action Menu"
                          >
                          <mat-icon>more_vert</mat-icon>
                        </button>
                        <mat-menu #actionMenu="matMenu"> </mat-menu>
                      </mat-cell>
                    </ng-container>
                    <!-- Select Checkbox Column -->
                    <ng-container matColumnDef="select">
                      <mat-header-cell *matHeaderCellDef>
                        <mat-checkbox
                          [checked]="isAllSelected"
                          (change)="onSelectAllChange($event)"
                          [indeterminate]="
                            selectedRowsForBulkDelete.size > 0 &&
                            selectedRowsForBulkDelete.size < tableSource.data.length
                          "
                          [attr.aria-label]="'ACTION.SELECT' | translate"
                        >
                        </mat-checkbox>
                      </mat-header-cell>
                      <mat-cell *matCellDef="let row">
                        <mat-checkbox
                          [checked]="isRowSelected(row.id)"
                          (change)="onCheckboxChange(row, $event)"
                          (click)="$event.stopPropagation()"
                          [attr.aria-label]="'ACTION.SELECT' | translate"
                        >
                        </mat-checkbox>
                      </mat-cell>
                    </ng-container>
                    <!--expandedTitle-->
                    <ng-container matColumnDef="expandedTitle">
                      <mat-cell *matCellDef="let row">
                        <div>
                          <span [innerHTML]="row.message | prettyLine"> </span>
                          <hr />
                          @if (row.updatedBy) {
                            {{ fieldsInfo["updatedBy"]?.fieldTitle }} :
                            {{ row.updatedBy | cmsuserinfo | async }}
                            <br />
                          }
                          <!-- statusTextFiltering -->
                          @if (row.statusTextFiltering) {
                            {{ fieldsInfo["statusTextFiltering"]?.fieldTitle }} :
                            {{
                            row.statusTextFiltering
                            ? ("MESSAGE.Yes" | translate)
                            : ("MESSAGE.No" | translate)
                            }}
                            <br />
                          }
                          <!-- statusNumberFiltering -->
                          @if (row.statusNumberFiltering) {
                            {{ fieldsInfo["statusNumberFiltering"]?.fieldTitle }} :
                            {{
                            row.statusNumberFiltering
                            ? ("MESSAGE.Yes" | translate)
                            : ("MESSAGE.No" | translate)
                            }}
                            <br />
                          }
                          <!-- textFilteringChar -->
                          @if (row.textFilteringChar) {
                            {{ fieldsInfo["textFilteringChar"]?.fieldTitle }} :
                            {{ row.textFilteringChar }}
                            <br />
                          }

                          @if (row.queueLockerId) {
                            {{ fieldsInfo["queueLockerId"]?.fieldTitle }} :
                            {{ row.queueLockerId }}
                            <br />
                          }
                          @if (row.queueLockerMicroservice) {
                            {{ fieldsInfo["queueLockerMicroservice"]?.fieldTitle }} :
                            {{ row.queueLockerMicroservice }}
                            <br />
                          }
                          @if (row.queueAllowNextRun) {
                            {{ fieldsInfo["queueAllowNextRun"]?.fieldTitle }} :
                            {{ row.queueAllowNextRun }}
                            <br />
                          }
                          <!-- isFlash -->
                          @if (row.isFlash) {
                            {{ fieldsInfo["isFlash"]?.fieldTitle }} :
                            {{
                            row.isFlash
                            ? ("MESSAGE.Yes" | translate)
                            : ("MESSAGE.No" | translate)
                            }}
                            <br />
                          }
                          <!-- linkApiPathId -->
                          @if (row.linkApiPathId) {
                            {{ fieldsInfo["linkApiPathId"]?.fieldTitle }} :
                            {{ row.linkApiPathId }}
                            <br />
                          }
                          <!-- linkFromNumber -->
                          @if (row.linkFromNumber) {
                            {{ fieldsInfo["linkFromNumber"]?.fieldTitle }} :
                            {{ row.linkFromNumber }}
                            <br />
                          }
                          <!-- scheduleSendStart -->
                          @if (row.scheduleSendStart) {
                            {{ fieldsInfo["scheduleSendStart"]?.fieldTitle }} :
                            {{ row.scheduleSendStart | localeDateTime }}
                            <br />
                          }
                          <!-- scheduleSendExpire -->
                          @if (row.scheduleSendExpire) {
                            {{ fieldsInfo["scheduleSendExpire"]?.fieldTitle }} :
                            {{ row.scheduleSendExpire | localeDateTime }}
                            <br />
                          }
                          <!-- toNumbers -->
                          @if (row.toNumbers) {
                            {{ fieldsInfo["toNumbers"]?.fieldTitle }} :
                            {{ row.toNumbers }}
                            <br />
                          }

                          <!-- statusNotStableApi -->
                          @if (row.statusNotStableApi) {
                            {{ fieldsInfo["statusNotStableApi"]?.fieldTitle }} :
                            {{
                            row.statusNotStableApi
                            ? ("MESSAGE.Yes" | translate)
                            : ("MESSAGE.No" | translate)
                            }}
                            <br />
                          }
                          <!-- statusOutOfServiceApi -->
                          @if (row.statusOutOfServiceApi) {
                            {{ fieldsInfo["statusOutOfServiceApi"]?.fieldTitle }} :
                            {{
                            row.statusOutOfServiceApi
                            ? ("MESSAGE.Yes" | translate)
                            : ("MESSAGE.No" | translate)
                            }}
                            <br />
                          }
                          <!-- numberFilteringChar -->
                          @if (row.numberFilteringChar) {
                            {{ fieldsInfo["numberFilteringChar"]?.fieldTitle }} :
                            {{ row.numberFilteringChar }}
                            <br />
                          }

                          <!-- queueCountRun -->
                          @if (row.queueCountRun) {
                            {{ fieldsInfo["queueCountRun"]?.fieldTitle }} :
                            {{ row.queueCountRun }}
                            <br />
                          }

                          <!-- queueLockedRun -->
                          @if (row.queueLockedRun) {
                            {{ fieldsInfo["queueLockedRun"]?.fieldTitle }} :
                            {{ row.queueLockedRun | localeDateTime }}
                            <br />
                          }
                          <!-- queueLockerExpire -->
                          @if (row.queueLockerExpire) {
                            {{ fieldsInfo["queueLockerExpire"]?.fieldTitle }} :
                            {{ row.queueLockerExpire | localeDateTime }}
                            <br />
                          }

                          <!-- queueCompleted -->
                          @if (row.queueCompleted) {
                            {{ fieldsInfo["queueCompleted"]?.fieldTitle }} :
                            {{
                            row.queueCompleted
                            ? ("MESSAGE.Yes" | translate)
                            : ("MESSAGE.No" | translate)
                            }}
                            <br />
                          }
                          <!-- queueCompleteDate -->
                          @if (row.queueCompleteDate) {
                            {{ fieldsInfo["queueCompleteDate"]?.fieldTitle }} :
                            {{ row.queueCompleteDate | localeDateTime }}
                            <br />
                          }
                          <!-- queueLockerMicroservice -->
                          @if (row.queueLockerMicroservice) {
                            {{ fieldsInfo["queueLockerMicroservice"]?.fieldTitle }} :
                            {{ row.queueLockerMicroservice }}
                            <br />
                          }
                        </div>
                      </mat-cell>
                    </ng-container>
                    <mat-header-row *matHeaderRowDef="tabledisplayedColumns"></mat-header-row>
                    <mat-row
                      *matRowDef="let row; columns: tabledisplayedColumns; let i = dataIndex"
                      class="ntk-row-mainfild"
                      (click)="onActionTableRowSelect(row, $event)"
                      (rtclick)="onActionTableRowSelect(row, $event)"
                      [class.ntk-row-selected]="row.id === tableRowSelected?.id"
                      >
                    </mat-row>
                    <mat-row
                      *matRowDef="let row; columns: ['expandedTitle']; let i = dataIndex"
                      class="ntk-row-expandedTitle"
                      (click)="onActionTableRowSelect(row, $event)"
                      (rtclick)="onActionTableRowSelect(row, $event)"
                      (mouseenter)="onActionTableRowMouseEnter(row)"
                      (mouseleave)="onActionTableRowMouseLeave(row)"
                      [class.ntk-row-selected]="row.id === tableRowSelected?.id"
                      >
                    </mat-row>
                  </mat-table>

                  <!--end:::::::::::::::::::::::::::::::::::::::::cms-body-->
                </ng-container>
                <ng-container cms-footer>
                  <!--begin:::::::::::::::::::::::::::::::::::::::::cms-footer-->

                  <mat-paginator
                    #paginator
                    [length]="dataModelResult.totalRowCount"
                    [pageIndex]="dataModelResult.currentPageNumber - 1"
                    [pageSize]="dataModelResult.rowPerPage"
                    [pageSizeOptions]="[5, 10, 20, 100]"
                    (page)="onTablePageingData($event)"
                  ></mat-paginator>

                  <!--end:::::::::::::::::::::::::::::::::::::::::cms-footer-->
                </ng-container>
              </app-cms-html-list>
