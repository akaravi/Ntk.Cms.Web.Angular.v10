<app-cms-html-list-mobile
  [optionsListInfoAreaId]="constructorInfoAreaId"
  [optionGuideNoticeKey]="''"
  [(optionActionGuideNoticeDisplay)]="viewGuideNotice"
  (optionOnActionButtonMemoRow)="onActionButtonMemoRow()"
  (optionOnActionButtonMemo)="onActionButtonMemo()"
  (optionOnActionButtonExport)="onActionButtonExport()"
  (optionOnActionButtonPrintRow)="onActionButtonPrintRow()"
  [optionTreeDisplay]="false"
  [optionActionRowId]="tableRowSelected?.id"
  [optionActionRowDisplay]="tableRowSelected?.id > 0"
  [optionActionRowDisplayMenu]="tableRowSelect2Click"
  [optionActionRowDisplayMenuAct]="tableRowSelectActionMenuClick"
  [optionSelectRowItemTitle]="tableRowSelected?.id"
  >
  <ng-container cms-tree></ng-container>
  <ng-container cms-header>
    @if (requestHeaderItemGroupId > 0) {
      <app-core-module-sale-header-group-header
        [optionId]="requestHeaderItemGroupId"
      ></app-core-module-sale-header-group-header>
    }
  </ng-container>
  <ng-container cms-action-header></ng-container>

  <ng-container cms-action-header-start>
    @if (requestHeaderItemGroupId > 0) {
      <a
        type="button"
        class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-gray"
        (click)="onActionBackToParent()"
        target="_blank"
        >
        <i class="fa-solid fa-arrow-left font-18" style="color: #ffffff"></i>
      </a>
    }
    <a
      type="button"
      class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-highlight"
      (click)="viewGuideNotice = !viewGuideNotice"
      target="_blank"
      ><i class="fa-solid fa-info font-18" style="color: #ffffff"></i></a>
    <a
      type="button"
      class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-highlight"
      (click)="onActionButtonReload()"
      target="_blank"
      ><i
        class="fa-solid fa-rotate-right font-18"
        style="color: #ffffff"
        [class.rotation360]="publicHelper.processService.process.inRunArea[constructorInfoAreaId]"
      ></i></a>
  </ng-container>

  <ng-container cms-action-header-end>
    <a
      (click)="optionsSearch.data.show = !optionsSearch.data.show"
      class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-highlight"
      ><mat-slide-toggle [checked]="optionsSearch.data.show"></mat-slide-toggle>
      {{ "ACTION.SEARCH" | translate }}</a>
    <a
      (click)="onActionButtonStatist()"
      class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-highlight"
      ><mat-slide-toggle [checked]="optionsStatist.data.show"> </mat-slide-toggle>
      {{ "ACTION.STATIST" | translate }}</a>
  </ng-container>

  <ng-container cms-action-main></ng-container>

  <ng-container cms-action-row>
    @if (dataModelResult?.access?.accessWatchRow && tableRowSelected?.id > 0) {
      <div class="col-4">
        <a
          (click)="onActionButtonViewRow(tableRowSelected)"
          type="button"
          class="btn font-13 font-600 btn-s m-1 rounded-s shadow-xl border-0 gradient-highlight"
          target="_blank"
          ><i class="fa-solid fa-eye font-18" style="color: #ffffff"></i><br /></a>
        <p class="font-11 text-center opacity-70">{{ "ACTION.VIEW" | translate }}</p>
      </div>
    }
  </ng-container>

  <ng-container cms-action-area>
    <app-cms-search-list [(options)]="optionsSearch"></app-cms-search-list>
    <app-cms-statist-list [(options)]="optionsStatist"></app-cms-statist-list>
  </ng-container>

  <ng-container cms-body>
    @if (dataModelResult?.listItems?.length) {
      <div class="cms-m-list">
        @for (row of dataModelResult.listItems; track row.id) {
          <div
            class="cms-m-list-item"
            [class.selected]="row.id === tableRowSelected?.id"
            (click)="onActionTableRowSelect(row, $event)"
            (rtclick)="onActionTableRowSelect(row, $event)"
            (mouseenter)="onActionTableRowMouseEnter(row)"
            (mouseleave)="onActionTableRowMouseLeave(row)"
            role="button"
            [attr.aria-label]="row.id"
            tabindex="0"
            >
            @if (row.mainImageSrc) {
              <div class="cms-m-list-item-image">
                <img [src]="row.mainImageSrc" [alt]="'Invoice ' + row.id" />
              </div>
            } @else {
              <div class="cms-m-list-item-image-placeholder">
                <i class="fa-solid fa-file-invoice" aria-hidden="true"></i>
              </div>
            }
            <div class="cms-m-list-item-content">
              <div class="cms-m-list-item-title">ID: {{ row.id }}</div>

              @if (row.recordStatus !== undefined) {
                <div class="cms-m-list-item-subtitle">
                  <i [ngClass]="row.recordStatus | statusIconClass"></i>
                </div>
              }
              @if (row.linkSiteIdBuyer) {
                <div class="cms-m-list-item-subtitle">
                  {{ fieldsInfo['linkSiteIdBuyer']?.fieldTitle }}: {{ row.linkSiteIdBuyer | cmssiteinfo | async }}
                </div>
              }

              @if (getRowExpanded(row)) {
                <div class="cms-m-list-item-expanded">
                  <div class="cms-m-list-item-subtitle">
                    <span
                      class="navi-icon pointer"
                      [cdkCopyToClipboard]="row.id.toString()"
                      (click)="$event.stopPropagation()"
                      ><i class="flaticon2-copy"></i></span>
                    ID: {{ row.id }}
                  </div>
                  @if (row.linkSiteIdBuyer) {
                    <div class="cms-m-list-item-subtitle">
                      {{ fieldsInfo['linkSiteIdBuyer']?.fieldTitle }}: {{ row.linkSiteIdBuyer | cmssiteinfo | async }}
                    </div>
                  }
                </div>
              }
            </div>
          </div>
        }
      </div>
    } @else {
      <div class="cms-m-empty">{{ "MESSAGE.NoRecord" | translate }}</div>
    }
  </ng-container>

  <ng-container cms-footer>
    <mat-paginator
      #paginator
      [length]="dataModelResult.totalRowCount"
      [pageIndex]="dataModelResult.currentPageNumber - 1"
      [pageSize]="dataModelResult.rowPerPage"
      [pageSizeOptions]="[5, 10, 20, 100]"
      (page)="onTablePageingData($event)"
    ></mat-paginator>
  </ng-container>
</app-cms-html-list-mobile>
